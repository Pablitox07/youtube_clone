<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Video Player</title>
  {% load static %}
  <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

  {% include "header.html" %}

  <div class="container mt-5">
    <!-- Video player -->
    <div class="mb-4">
      <video id="player" playsinline controls class="w-100 rounded">
        <source src="{{ video_path }}" type="video/mp4" />
        Your browser does not support HTML5 video.
      </video>
    </div>

    <h2 class="mb-4">{{ title }}</h2>

    <!-- Uploader and stats -->
    <div class="d-flex align-items-center mb-3">
      <img src="{{ uploader_profile_pic }}" alt="Profile Picture" class="rounded-circle me-2" width="50" height="50">
      <div>
        <strong>{{ uploader_username }}</strong><br>
        <small>{{ video_views }} views</small>
      </div>
    </div>

    <!-- Description -->
    <div class="mb-3">
      <p>{{ description }}</p>
    </div>

    <!-- Like / Dislike buttons with counts -->
    <div class="mb-4 d-flex align-items-center">
      <button class="btn btn-outline-success me-2" id="video_like_buton">
        Like ({{ likes }})
      </button>
    
      <button class="btn btn-outline-danger" id="video_dislike_buton">
        Dislike ({{ dislikes }})
      </button>
    </div>
    

    <!-- Comments Section -->
    <div class="mt-5">
      <h4>Comments</h4>
      <form method="POST" action="/videos/{{ video_id }}/comment">
        {% csrf_token %}
        <textarea name="comment" class="form-control mb-2" placeholder="Add a comment..." rows="2"></textarea>
        <button class="btn btn-secondary" type="submit">Post Comment</button>
      </form>

      <ul class="list-group mt-3">
        {% for comment in comments %}
          <li class="list-group-item">
            <strong>{{ comment.user }}</strong>: {{ comment.text }}
          </li>
        {% empty %}
          <li class="list-group-item">No comments yet.</li>
        {% endfor %}
      </ul>
    </div>
  </div>

  <!-- Plyr JS -->
  <script src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js"></script>
  <script>
    let like_dislike_status = "";
    let received_likes = parseInt("{{ likes }}", 10); 
    let received_dislikes = parseInt("{{dislikes}}", 10)
    const received_video_id = "{{ video_id }}"; 
    document.addEventListener("DOMContentLoaded", () => {
      const player = new Plyr('#player');
    });
  </script>
  <script type="module" src="/static/js/videos_view.js"></script>
</body>
</html>
